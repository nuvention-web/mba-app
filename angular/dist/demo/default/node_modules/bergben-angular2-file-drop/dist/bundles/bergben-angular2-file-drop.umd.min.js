!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("fileapi")):"function"==typeof define&&define.amd?define(["exports","@angular/core","fileapi"],t):t(e["bergben-angular2-file-drop"]=e["bergben-angular2-file-drop"]||{},e.ng.core)}(this,function(e,t){"use strict";var r=function(e,t,r,i){var o,n=arguments.length,p=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)p=Reflect.decorate(e,t,r,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(p=(n<3?o(p):n>3?o(t,r,p):o(t,r))||p);return n>3&&p&&Object.defineProperty(t,r,p),p},i=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};e.FileDropDirective=function(){function e(e){this.fileOver=new t.EventEmitter,this.onFileDrop=new t.EventEmitter,this.element=e}return e.prototype.onDragOver=function(e){var t=this.getDataTransfer(e);this.haveFiles(t.types)&&(t.dropEffect="copy",this.preventAndStop(e),this.emitFileOver(!0))},e.prototype.onDragLeave=function(e){e.currentTarget!==this.element[0]&&(this.preventAndStop(e),this.emitFileOver(!1))},e.prototype.onDrop=function(e){var t=this.getDataTransfer(e);if(t){this.preventAndStop(e),this.emitFileOver(!1);for(var r=0;r<t.files.length;r++)this.readFile(t.files[r])}},e.prototype.readFile=function(e){var t=this,r=this.pickStrategy();if(r){var i="readAs"+r;FileAPI[i](e,function(r){if("load"===r.type)t.emitFileDrop(r.result);else if("error"===r.type)throw new Error("Couldn't read file '"+e.name+"'")})}else this.emitFileDrop(e)},e.prototype.emitFileOver=function(e){this.fileOver.emit(e)},e.prototype.emitFileDrop=function(e){this.onFileDrop.emit(e)},e.prototype.pickStrategy=function(){if(this.options)return this.hasStrategy(this.options.readAs)?this.options.readAs:void 0},e.prototype.hasStrategy=function(e){return["DataURL","BinaryString","ArrayBuffer","Text"].indexOf(e)!==-1},e.prototype.getDataTransfer=function(e){return e.dataTransfer?e.dataTransfer:e.originalEvent.dataTransfer},e.prototype.preventAndStop=function(e){e.preventDefault(),e.stopPropagation()},e.prototype.haveFiles=function(e){return!!e&&(e.indexOf?e.indexOf("Files")!==-1:!!e.contains&&e.contains("Files"))},e}(),r([t.Output(),i("design:type",t.EventEmitter)],e.FileDropDirective.prototype,"fileOver",void 0),r([t.Output(),i("design:type",t.EventEmitter)],e.FileDropDirective.prototype,"onFileDrop",void 0),r([t.Input(),i("design:type",Object)],e.FileDropDirective.prototype,"options",void 0),r([t.HostListener("dragover",["$event"]),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],e.FileDropDirective.prototype,"onDragOver",null),r([t.HostListener("dragleave",["$event"]),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],e.FileDropDirective.prototype,"onDragLeave",null),r([t.HostListener("drop",["$event"]),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],e.FileDropDirective.prototype,"onDrop",null),e.FileDropDirective=r([t.Directive({selector:"[fileDrop]"}),i("design:paramtypes",[t.ElementRef])],e.FileDropDirective);var o=function(e,t,r,i){var o,n=arguments.length,p=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)p=Reflect.decorate(e,t,r,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(p=(n<3?o(p):n>3?o(t,r,p):o(t,r))||p);return n>3&&p&&Object.defineProperty(t,r,p),p};e.FileDropModule=function(){function e(){}return e}(),e.FileDropModule=o([t.NgModule({declarations:[e.FileDropDirective],exports:[e.FileDropDirective]})],e.FileDropModule),Object.defineProperty(e,"__esModule",{value:!0})});