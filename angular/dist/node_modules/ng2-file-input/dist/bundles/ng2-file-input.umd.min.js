!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("@angular/platform-browser"),require("@angular/common"),require("bergben-angular2-file-drop")):"function"==typeof define&&define.amd?define(["exports","@angular/core","@angular/platform-browser","@angular/common","bergben-angular2-file-drop"],t):t(e["ng2-file-input"]={},e.ng.core,e.platformBrowser,e.common,e.bergbenAngular2FileDrop)}(this,function(e,t,i,n,r){"use strict";var o=function(){function e(){this.fileInputs=[]}return e.prototype.add=function(e){return this.fileInputs.push({id:e,currentFiles:[]}),!0},e.prototype.remove=function(e){for(var t=0;this.fileInputs.length;t++)if(this.fileInputs[t].id===e)return this.fileInputs.splice(t,1),t=this.fileInputs.length,!0;return!1},e.prototype.reset=function(e){return this.getFileInput(e).currentFiles=[],!0},e.prototype.addFiles=function(e,t){var i=this,n=this.getFileInput(e),r=[];return t.forEach(function(e){i.addFile(e,n.currentFiles)||r.push(e)}),r},e.prototype.removeFiles=function(e,t){var i=this,n=this.getFileInput(e),r=[];return t.forEach(function(e){i.removeFile(e,n.currentFiles)||r.push(e)}),r},e.prototype.getFileInput=function(e){for(var t=0;this.fileInputs.length;t++)if(this.fileInputs[t].id===e)return this.fileInputs[t]},e.prototype.addFile=function(e,t){return t.push(e),!0},e.prototype.removeFile=function(e,t){for(var i=0;t.length;i++)if(this.isSameFile(e,t[i]))return t.splice(i,1),i=t.length,!0;return!1},e.prototype.isSameFile=function(e,t){return e.name===t.name&&e.size===t.size&&e.type===t.type},e.decorators=[{type:t.Injectable}],e.ctorParameters=function(){return[]},e}(),s=function(){return function(){this.dropText="Drop file here",this.browseText="Browse",this.removeText="Remove",this.invalidFileText="You have picked an invalid or disallowed file.",this.invalidFileTimeout=8e3,this.removable=!0,this.multiple=!1,this.accept="",this.showPreviews=!0,this.extensions=[]}}();!function(e){e[e.Removed=0]="Removed",e[e.Added=1]="Added",e[e.InvalidDenied=2]="InvalidDenied",e[e.CouldNotRemove=3]="CouldNotRemove",e[e.CouldNotAdd=4]="CouldNotAdd"}(e.Ng2FileInputAction||(e.Ng2FileInputAction={}));var l=function(){function n(e,i,n){this.fileInputHandlerService=e,this.sanitizer=i,this.defaultOptions=n,this.alreadyEmitted=!1,this.fileIsOver=!1,this.invalidFile=!1,this.multiple=null,this.removable=null,this.showPreviews=null,this.outputAction=new t.EventEmitter,this.outputRemoved=new t.EventEmitter,this.outputAdded=new t.EventEmitter,this.outputInvalidDenied=new t.EventEmitter,this.outputCouldNotRemove=new t.EventEmitter,this.outputCouldNotAdd=new t.EventEmitter}return n.prototype.ngOnInit=function(){this.dropText=this.dropText||this.defaultOptions.dropText,this.browseText=this.browseText||this.defaultOptions.browseText,this.removeText=this.removeText||this.defaultOptions.removeText,this.invalidFileText=this.invalidFileText||this.defaultOptions.invalidFileText,this.invalidFileTimeout=this.invalidFileTimeout||this.defaultOptions.invalidFileTimeout,this.multiple=null!==this.multiple?this.multiple:this.defaultOptions.multiple,this.accept=null!==this.accept?this.accept:this.defaultOptions.accept,this.removable=null!==this.removable?this.removable:this.defaultOptions.removable,this.showPreviews=null!==this.showPreviews?this.showPreviews:this.defaultOptions.showPreviews,this.extensions=this.extensions||this.defaultOptions.extensions,void 0!==this.id&&this.id&&null!==this.id||(this.id=this.generateId()),this.fileInputHandlerService.add(this.id)},n.prototype.ngOnDestroy=function(){this.fileInputHandlerService.remove(this.id)},n.prototype.fileOver=function(e){this.fileIsOver=e},n.prototype.onFileDrop=function(e){var t=this;this.multiple?this.handleFile(e):this.alreadyEmitted||(this.alreadyEmitted=!0,this.handleFile(e),setTimeout(function(){t.alreadyEmitted=!1},0))},n.prototype.fileSelected=function(e){this.invalidFile=!1;var t=e.target.files;if(t&&t.length)if(this.multiple)for(var i=0;i<t.length;i++)this.handleFile(t[i]);else this.handleFile(t[0]);setTimeout(function(){e.target.value=""},0)},n.prototype.getCurrentFiles=function(){var e=this.fileInputHandlerService.getFileInput(this.id);return e?e.currentFiles:[]},n.prototype.removeFile=function(t){if(this.removable){0===this.fileInputHandlerService.removeFiles(this.id,[t]).length?this.emitOutput(t,e.Ng2FileInputAction.Removed):this.emitOutput(t,e.Ng2FileInputAction.CouldNotRemove)}},n.prototype.getObjectUrl=function(e){return this.sanitizer.bypassSecurityTrustResourceUrl(window.URL.createObjectURL(e))},n.prototype.handleFile=function(t){if(this.isValidFile(t)){this.multiple||this.fileInputHandlerService.reset(this.id);0===this.fileInputHandlerService.addFiles(this.id,[t]).length?this.emitOutput(t,e.Ng2FileInputAction.Added):this.emitOutput(t,e.Ng2FileInputAction.CouldNotAdd)}else this.emitOutput(t,e.Ng2FileInputAction.InvalidDenied)},n.prototype.emitOutput=function(t,i){switch(this.outputAction.emit({id:this.id,currentFiles:this.getCurrentFiles(),action:i,file:t}),i){case e.Ng2FileInputAction.Added:this.outputAdded.emit({id:this.id,currentFiles:this.getCurrentFiles(),file:t});break;case e.Ng2FileInputAction.Removed:this.outputRemoved.emit({id:this.id,currentFiles:this.getCurrentFiles(),file:t});break;case e.Ng2FileInputAction.InvalidDenied:this.outputInvalidDenied.emit({id:this.id,currentFiles:this.getCurrentFiles(),file:t});break;case e.Ng2FileInputAction.CouldNotAdd:this.outputCouldNotAdd.emit({id:this.id,currentFiles:this.getCurrentFiles(),file:t});break;case e.Ng2FileInputAction.CouldNotRemove:this.outputCouldNotRemove.emit({id:this.id,currentFiles:this.getCurrentFiles(),file:t})}},n.prototype.isValidFile=function(e){var t=this;if(this.extensions.length>0){var i=e.name.split(".").pop();if(-1!==this.extensions.indexOf("image/jpg")&&-1===this.extensions.indexOf("image/jpeg")&&this.extensions.push("image/jpeg"),-1===this.extensions.indexOf(e.type)&&-1===this.extensions.indexOf(i))return this.invalidFile=!0,0!==this.invalidFileTimeout&&setTimeout(function(){t.invalidFile=!1},this.invalidFileTimeout),!1}return!0},n.prototype.generateId=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})},n.decorators=[{type:t.Component,args:[{selector:"ng2-file-input",template:'<div class="ng2-file-input">\n                    <div class="ng2-file-input-invalid text-danger" [hidden]="!invalidFile" [innerHTML]="invalidFileText"></div>\n                    <div fileDrop class="ng2-file-input-drop-container" [ngClass]="{\'file-is-over\': fileIsOver}" (fileOver)="fileOver($event)"\n                        (onFileDrop)="onFileDrop($event)">\n                        <span [innerHTML]="dropText"></span>\n                        <button type="button" (click)="ng2FileInputSelect.click()" class="btn btn-primary" [innerHTML]="browseText"></button>\n                    </div>\n                    <div class="ng2-file-input-files" *ngIf="showPreviews">\n                        <div *ngFor="let file of getCurrentFiles()" class="ng2-file-input-file" [ngClass]="{\'image\':file.type.indexOf(\'image\')!==-1}">\n                            <span [innerHTML]="file.name" class="ng2-file-input-file-text"></span>\n                            <img [src]="getObjectUrl(file)" *ngIf="file.type.indexOf(\'image\')!==-1">\n                            <span class="ng2-file-input-file-text remove" (click)="removeFile(file)" *ngIf="removable">\n                                <p [innerHTML]="removeText"></p>\n                            </span> \n                        </div>\n                    </div>\n                    <input type="file" #ng2FileInputSelect (change)="fileSelected($event)" [accept]="accept" [attr.multiple]="multiple ? true : null">\n                </div>'}]}],n.ctorParameters=function(){return[{type:o,decorators:[{type:t.Inject,args:[t.forwardRef(function(){return o})]}]},{type:i.DomSanitizer,decorators:[{type:t.Inject,args:[t.forwardRef(function(){return i.DomSanitizer})]}]},{type:s,decorators:[{type:t.Inject,args:[t.forwardRef(function(){return s})]}]}]},n.propDecorators={id:[{type:t.Input}],dropText:[{type:t.Input,args:["drop-text"]}],browseText:[{type:t.Input,args:["browse-text"]}],removeText:[{type:t.Input,args:["remove-text"]}],invalidFileText:[{type:t.Input,args:["invalid-file-text"]}],invalidFileTimeout:[{type:t.Input,args:["invalid-file-timeout"]}],multiple:[{type:t.Input,args:["multiple"]}],accept:[{type:t.Input,args:["accept"]}],removable:[{type:t.Input,args:["removable"]}],showPreviews:[{type:t.Input,args:["show-previews"]}],extensions:[{type:t.Input,args:["extensions"]}],outputAction:[{type:t.Output,args:["onAction"]}],outputRemoved:[{type:t.Output,args:["onRemoved"]}],outputAdded:[{type:t.Output,args:["onAdded"]}],outputInvalidDenied:[{type:t.Output,args:["onInvalidDenied"]}],outputCouldNotRemove:[{type:t.Output,args:["onCouldNotRemove"]}],outputCouldNotAdd:[{type:t.Output,args:["onCouldNotAdd"]}]},n}(),u=function(){function e(e){this.fileInputHandlerService=e}return e.prototype.reset=function(e){return this.fileInputHandlerService.reset(e)},e.prototype.remove=function(e,t){return this.fileInputHandlerService.removeFiles(e,t)},e.prototype.add=function(e,t){return this.fileInputHandlerService.addFiles(e,t)},e.prototype.getCurrentFiles=function(e){var t=this.fileInputHandlerService.getFileInput(e);return t?t.currentFiles:[]},e.decorators=[{type:t.Injectable}],e.ctorParameters=function(){return[{type:o,decorators:[{type:t.Inject,args:[t.forwardRef(function(){return o})]}]}]},e}(),p=new t.InjectionToken("ng2 file input custom user options"),d=function(){function e(){}return e.forRoot=function(t){return void 0===t&&(t={}),{ngModule:e,providers:[{provide:p,useValue:t},{provide:s,useFactory:function(e){var t=new s;return Object.assign(t,e),t},deps:[p]}]}},e.decorators=[{type:t.NgModule,args:[{imports:[n.CommonModule,r.FileDropModule],providers:[u,o],declarations:[l],exports:[l]}]}],e.ctorParameters=function(){return[]},e}();e.Ng2FileInputComponent=l,e.FileInputHandlerService=o,e.Ng2FileInputService=u,e.Ng2FileInputOptions=s,e.Ng2FileInputModule=d,Object.defineProperty(e,"__esModule",{value:!0})});